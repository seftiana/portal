<!-- patTemplate:tmpl name="content" -->
   <h2>Scan QRCode</h2>
		
   <br />
   <!-- patTemplate:link name="error_box" src="error_box" / -->

   <!-- patTemplate:tmpl name="keterangan" visibility="hidden" -->
	<a href="{LINK_BACK}" class="btn btn-info">Kembali</a>
	<div class="table-responsive">

		<div id="reader" style="width:300px; margin:auto"></div>
		<div id="loading" 
			 style="display:none;
					background:#000000aa;
					position:fixed;
					top:0; left:0;
					width:100%; height:100%;
					color:white; font-size:22px;
					text-align:center; padding-top:200px;
					z-index:9999;">
			Sedang diproses...
		</div>
		
		<script src="https://unpkg.com/html5-qrcode"></script>
		<script>
			var html5QrcodeScanner;
			function onScanSuccess(decodedText) {
				
				// Tampilkan loading
				document.getElementById("loading").style.display = "block";
			
				// Hentikan scanner supaya tidak scan 2x
				html5QrcodeScanner.clear().catch(err => {});
				// Redirect
				//window.location = "index.php?pModule=presensi&pSub=scan&pAct=proses&niu={MHSNIU}&qr=" + encodeURIComponent(decodedText);
				window.location = "{LINK_SCAN}&qr=" + encodeURIComponent(decodedText);
			}

			// Inisialisasi scanner
			var html5QrcodeScanner = new Html5QrcodeScanner(
				"reader",
				{
					fps: 10, 
					qrbox: 250 
				}
			);
			html5QrcodeScanner.render(onScanSuccess);
		</script>

	</div>
	<br/>
	<br/>

	<!-- /patTemplate:tmpl -->
	<!-- /patTemplate:tmpl -->
<!-- end of content -->